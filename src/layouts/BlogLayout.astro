---
import BaseLayout from './BaseLayout.astro';
import type { CollectionEntry } from 'astro:content';

interface Props {
  post: CollectionEntry<'blog'>;
}

const { post } = Astro.props;
const { title, description, pubDate, tags } = post.data;

// Calculate reading time (~200 words per minute)
const words = post.body?.split(/\s+/).length || 0;
const readingTime = Math.max(1, Math.ceil(words / 200));
---
<BaseLayout
  title={`${title} - Quang`}
  description={description}
  type="article"
  publishedTime={pubDate}
  tags={tags}
>
  <article class="prose prose-neutral dark:prose-invert max-w-none">
    <header class="mb-8 not-prose">
      <div class="flex items-center gap-2 text-sm text-[var(--text-secondary)]">
        <time>
          {pubDate.toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
          })}
        </time>
        <span>Â·</span>
        <span>{readingTime} min read</span>
      </div>
      <h1 class="text-3xl font-bold mt-3 tracking-tight">{title}</h1>
      {tags.length > 0 && (
        <div class="flex flex-wrap gap-2 mt-4">
          {tags.map(tag => (
            <span class="px-2 py-1 text-xs rounded-full bg-[var(--accent)]/10 text-[var(--accent)]">
              {tag}
            </span>
          ))}
        </div>
      )}
    </header>

    <slot />
  </article>

  <footer class="mt-12 pt-8 border-t border-[var(--border)]">
    <a href="/blog" class="text-[var(--accent)] hover:underline inline-flex items-center gap-1">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
      Back to blog
    </a>
  </footer>
</BaseLayout>
